rules:
  - id: promise-without-catch
    patterns:
      - pattern: $PROMISE.then(...)
      - pattern-not: $PROMISE.then(...).catch(...)
    message: >-
      `.then()` chain without `.catch()` — unhandled promise rejection will crash
      at runtime.
    severity: WARNING
    languages: [typescript, javascript]
    metadata:
      category: correctness

  - id: console-log-left-in
    pattern: console.log(...)
    paths:
      exclude:
        - "*test*"
        - "*spec*"
        - "*.test.*"
        - "*.spec.*"
    message: >-
      `console.log()` left in production code — remove or replace with a proper
      logger.
    severity: INFO
    languages: [typescript, javascript]
    metadata:
      category: quality

  - id: hardcoded-url-string
    patterns:
      - pattern: $VAR = "=~/https?:\/\//"
    message: >-
      Hardcoded URL in `$VAR` — extract to a configuration constant or
      environment variable.
    severity: WARNING
    languages: [typescript, javascript]
    metadata:
      category: correctness

  - id: any-type-escape-hatch
    pattern: $EXPR as any
    message: >-
      `as any` bypasses TypeScript type checking — use a proper type or generic
      instead.
    severity: WARNING
    languages: [typescript]
    metadata:
      category: quality

  - id: non-null-assertion
    pattern: $EXPR!
    message: >-
      Non-null assertion `!` bypasses null checks — use optional chaining
      or explicit null handling instead.
    severity: WARNING
    languages: [typescript]
    metadata:
      category: quality

  - id: dangerously-set-inner-html
    pattern-either:
      - pattern: <$EL dangerouslySetInnerHTML={$VALUE} />
      - pattern: <$EL dangerouslySetInnerHTML={$VALUE}>...</$EL>
    message: >-
      `dangerouslySetInnerHTML` is an XSS vector — sanitize input or use
      a safe rendering library.
    severity: ERROR
    languages: [typescript, javascript]
    metadata:
      category: security

  - id: no-await-in-loop
    patterns:
      - pattern: |
          for (...) {
            ...
            await $EXPR
            ...
          }
    message: >-
      `await` inside a loop runs sequentially — use `Promise.all()` for
      parallel execution when order doesn't matter.
    severity: WARNING
    languages: [typescript, javascript]
    metadata:
      category: correctness
